<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Roles</title>
    <link rel="stylesheet" th:href="@{/css/index.css}">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body class="body2">
<!-- Aquí se inserta el header -->
<div th:replace="~{itemss/headeradmin :: miHeader}"></div>
<div class="main">
    <div class="card">
        <h1 th:text="${rol != null and rol.id_rol != null} ? 'Editar Rol' : 'Gestión de roles'"></h1>

        <form class="formulario-mensaje" th:action="@{/roles/guardar}" method="post" th:object="${rol}">
            <div class="form-group">
                <input type="text" name="desc_rol" placeholder="Nombre del Rol" th:field="*{nomRol}" required>
            </div>
            <button type="submit" class="save-btn">Insertar</button>
        </form>

        <div id="mensaje" th:if="${param.success}" style="color:purple; font-weight:bold; margin-bottom:10px;">
            ¡Se insertó correctamente!
        </div>
    </div>

    <div id="search" class="search">
        <form th:action="@{/roles/buscar}" method="get">
            <input type="text" name="nomRol" placeholder="Ingrese el nombre del rol" id="searchInput">
            <input type="submit" value="Buscar" id="btnSearch">
        </form>
    </div>

    <table>
        <thead>
        <tr>
            <th>Código</th>
            <th>Rol</th>
            <th>Acciones</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="r : ${roles}">
            <td th:text="${r.id_rol}"></td>
            <td th:text="${r.nomRol}"></td>
            <td>
                <a class="btn-accion" th:href="@{'/roles/editar/' + ${r.id_rol}}">Actualizar</a>
                <a class="btn-eliminar" th:href="@{'/roles/eliminar/' + ${r.id_rol}}">Eliminar</a>
            </td>
        </tr>
        <tr th:if="${#lists.isEmpty(roles)}">
            <td colspan="3">No se encontraron resultados</td>
        </tr>
        </tbody>
    </table>
</div>

<script src="/js/confirmacion.js"></script>
<script src="/js/eliminar.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const toggleBtn = document.getElementById("formToggle");
        const submenu = document.getElementById("submenuForm");

        if (toggleBtn && submenu) {
            toggleBtn.addEventListener("click", function(e) {
                e.preventDefault();
                submenu.classList.toggle("show");
            });
        }
    });
</script>
</body>
</html>
